type Viewer

interface Node {
  id: ID!

  # Metadata
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
  _version: Int
  _deleted: Boolean @readonly
}

enum UserStatus {
  ACTIVE
  DISABLED
  SUSPENDED
}

type User @model {
  id: ID!
  firstName: String
  lastName: String
  email: AWSEmail
  picture: AWSURL
  status: UserStatus @readonly
}

type Task @model(operations: [upsert, delete]) {
  id: ID!
  title: String
  content: AWSJSON
  schedule: Schedule
  rrule: RRule
  recurrenceId: ID
  occurrenceId: String

  # Connections
  labels: Label @connection(relation: "manyMany")
  subtasks: Task @edges
  artifacts: Artifact @edges(relation: "manyMany")
  occurrences: Task @edges(relation: "oneMany")
}

type RRule {
  dtStart: AWSDateTime
  until: AWSDateTime
  ruleStr: String
}

type Schedule {
  startDate: DateTimeZone
  duration: String
  dueDate: DateTimeZone
}

type DateTimeZone {
  date: AWSDateTime
  timezone: String
}

type Label @model(operations: [upsert, delete]) {
  id: ID!
  name: String
  color: String
}

type File @model(operations: [upsert, delete]) {
  name: String
  size: Int
  url: AWSURL
  mimeType: String
}

type TimeTracker @model(operations: [upsert, delete]) {
  duration: String
  logs: [TimeLog!]
}

type TimeLog {
  action: TimeLogAction!
  timestamp: AWSTimestamp!
}

enum TimeLogAction {
  START
  PAUSE
  END
  LOG
}

union Artifact = File | TimeTracker

extend type Viewer {
  user: User @node
  tasks: Task @edges
  labels: Label @edges
}

type Query {
  viewer: Viewer!
}
